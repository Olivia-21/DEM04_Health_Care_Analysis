QUESTION 1: Monthly Encounters by Specialty
SQL QUERY:

EXPLAIN ANALYZE
SELECT
  d.year,
  d.month,
  s.specialty_name,
  et.encounter_type_name,
  COUNT(*) AS total_encounters
FROM fact_encounters f
JOIN dim_date d ON f.date_key = d.date_key
JOIN dim_specialty s ON f.specialty_key = s.specialty_key
JOIN dim_encounter_type et ON f.encounter_type_key = et.encounter_type_key
GROUP BY d.year, d.month, s.specialty_name, et.encounter_type_name;


Execution Time Estimate: 53.1ms vs 51.5ms
Improvement factor: 1x faster
Explanation
Ans: Star schema is about the same as OLTP because the query still aggregates over a large fact table and both need similar joins. There is no huge advantage since the data is not big enough to benefit from denormalization.






QUESTION 2: Diagnosis-Procedure Pairs
SQL QUERY:
EXPLAIN ANALYZE
SELECT
  bd.diagnosis_code,
  bp.procedure_code,
  COUNT(*) AS encounter_count
FROM bridge_encounter_diagnoses bd
JOIN bridge_encounter_procedures bp
  ON bd.encounter_key = bp.encounter_key
GROUP BY bd.diagnosis_code, bp.procedure_code;


Execution Time Estimate: 65.1ms vs 309ms
Improvement factor: 5x faster
Explanation
Ans: Star schema is much faster because it uses pre-keyed bridge tables and fewer joins, avoiding multiple heavy table lookups that OLTP has, though both still experience some row multiplication.






QUESTION 3: Readmission Rate
SQL QUERY:

EXPLAIN ANALYZE
SELECT
  s.specialty_name,
  COUNT(*) AS readmissions
FROM fact_encounters f1
JOIN fact_encounters f2
  ON f1.patient_key = f2.patient_key
 AND f2.date_key BETWEEN f1.date_key AND f1.date_key + 30
JOIN dim_specialty s
  ON f1.specialty_key = s.specialty_key
WHERE f1.encounter_type_key = 2
GROUP BY s.specialty_name;


Execution Time Estimate: 260ms vs 51.1ms
Improvement factor:0.19
Explanation
Ans: Star schema is slower here because of the self-join on the large fact table, which creates many row comparisons. OLTP is faster because it likely scans fewer rows or has smaller join sets for this query.






QUESTION 4: Revenue by Specialty and Month
SQL QUERY:

EXPLAIN ANALYZE
SELECT
  d.year,
  d.month,
  s.specialty_name,
  SUM(f.total_allowed_amount) AS revenue
FROM fact_encounters f
JOIN dim_date d ON f.date_key = d.date_key
JOIN dim_specialty s ON f.specialty_key = s.specialty_key
GROUP BY d.year, d.month, s.specialty_name;


Execution Time Estimate: 37.8ms vs 85.5ms
Improvement factor: 2.26x faster
Explanation
Ans: Star schema is faster because the fact table already stores total allowed amounts and keys to small dimensions, so aggregation is quicker, whereas OLTP needs multiple joins and calculations like DATE_FORMAT





