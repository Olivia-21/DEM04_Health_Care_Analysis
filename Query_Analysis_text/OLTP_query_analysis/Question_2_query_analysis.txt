QUESTION 2
SQL QUERY:

EXPLAIN ANALYZE
SELECT
    d.icd10_code,
    pr.cpt_code,
    COUNT(*) AS encounter_count
FROM encounter_diagnoses ed
JOIN diagnoses d ON ed.diagnosis_id = d.diagnosis_id
JOIN encounter_procedures ep ON ed.encounter_id = ep.encounter_id
JOIN procedures pr ON ep.procedure_id = pr.procedure_id
GROUP BY d.icd10_code, pr.cpt_code
ORDER BY encounter_count DESC;


SCHEMA ANALYSIS:
Tables joined: encounter_diagnoses, diagnoses, encounter_procedures and procedures
Number of joins: 3
Performance:
Execution time: 229ms
Estimated rows scanned:36674
Bottleneck Identified:

Why is this slow?
Ans: The query is slow because MySQL must first create a temporary table to store grouped results and then perform a full scan and sort on that temporary table. 

What's the root cause?
Ans: The root cause is running analytics-style queries(GROUP BY, ORDER BY) on a normalized OLTP schema. OLTP tables are optimized for transaction which forces the database to create temporary tables and perform expensive scans and sorts. 
