QUESTION 4
SQL QUERY:

SELECT
    DATE_FORMAT(b.claim_date, '%Y-%m') AS claim_month,
    s.specialty_name,
    SUM(b.allowed_amount) AS total_revenue
FROM billing b
JOIN encounters e ON b.encounter_id = e.encounter_id
JOIN providers p ON e.provider_id = p.provider_id
JOIN specialties s ON p.specialty_id = s.specialty_id
GROUP BY
    DATE_FORMAT(b.claim_date, '%Y-%m'),
    s.specialty_name
ORDER BY total_revenue DESC;

SCHEMA ANALYSIS:
Tables joined: billing, encounters, providers and specialties
Number of joins: 3
Performance:
Execution time: 118ms
Estimated rows scanned: 500 rows
Bottleneck Identified:

Why is this slow?
Ans: Because there is a multiple table join before performing aggregation. After the joins, MySQL calculates total revenue and groups the data by month and specialty, which requires additional processing and sorting. 

What's the root cause?
Ans: There is a long join chain combined with aggregation on a normalized OLTP schema. Revenue data is stored separately from the descriptive attributes like specialty, so the database must join several tables and process more rows than necessary. 

